# Define the report file path
$reportDate = Get-Date -Format "yyyy-MM-dd"
$reportPath = "C:\Project3\report_$reportDate.txt"

# Create or clear the report file
New-Item -Path $reportPath -ItemType File -Force | Out-Null

# Add system info
Add-Content -Path $reportPath -Value "=== Daily System Report: $reportDate ===`n"
Add-Content -Path $reportPath -Value "`n--- System Info ---"
Add-Content -Path $reportPath -Value (Get-ComputerInfo | Select-Object CsName, OsName, OsArchitecture, WindowsVersion | Out-String)

# Add disk usage
Add-Content -Path $reportPath -Value "`n--- Disk Usage ---"
Get-PSDrive -PSProvider 'FileSystem' | ForEach-Object {
    $line = "$($_.Name): Used = $([math]::Round($_.Used/1GB,2)) GB, Free = $([math]::Round($_.Free/1GB,2)) GB"
    Add-Content -Path $reportPath -Value $line
}

# Add recent event logs (last 24 hours)
Add-Content -Path $reportPath -Value "`n--- Event Logs (Last 24 Hours) ---"
$yesterday = (Get-Date).AddDays(-1)
Get-WinEvent -FilterHashtable @{LogName='System'; StartTime=$yesterday} -MaxEvents 10 | Format-Table TimeCreated, Id, Message -AutoSize | Out-String | Add-Content -Path $reportPath

# Completion message
Write-Output "Daily report generated at: $reportPath"





____________

powershell.exe
-ExecutionPolicy Bypass -File "C:\Project3\DailyLog.ps1"

___________________

Compress-Archive -Path "C:\Project3\report_2025-09-17.txt" -DestinationPath "C:\Project3\name_output.zip" -Force